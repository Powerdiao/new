Using backend: pytorch
main_link_prediction.py[line:410]: - Namespace(batch_size=100000, dataset='ACMDataset', decoder='DisMult', dropout=0.05, eval_every=1, fan_out='10,25', gpu=1, log_every=20, loss='CrossEntropyLoss', lr=0.001, margin=10.0, model='HinSAGE', neg_share=False, num_epochs=10, num_eval_negs=100, num_heads=[8, 4], num_hidden=64, num_layers=2, num_negs=3, num_output=64, num_workers=0)
Finished data loading.
  NumNodes: 30003
  NumEdges: 160686
  NumFeats: 128
  NumNodesType: 3
  NumRelsType: 6
main_link_prediction.py[line:168]: - --------------------------------------------------
main_link_prediction.py[line:169]: - Dataloader size: 2
main_link_prediction.py[line:170]: - Dataloader sample graph: 160686
main_link_prediction.py[line:171]: - Train Edges: 136587
main_link_prediction.py[line:172]: - Test Edges: 8020
main_link_prediction.py[line:173]: - Valid Edges: 16079
main_link_prediction.py[line:181]: - --------------------------------------------------
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/dgl/base.py:45: DGLWarning: Key word argument preserve_nodes is deprecated. Use relabel_nodes instead.
  return warnings.warn(message, category=category, stacklevel=1)
main_link_prediction.py:235: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370156314/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  select_ids = torch.cat([(input_nodes[k] == i).nonzero() for i in pos_graph.ndata['_ID'][k]]).squeeze()
main_link_prediction.py[line:299]: - Epoch Time(s): 7.3624
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3441: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
main_link_prediction.py[line:303]: - [Total] Epoch 00000 | Step 00001 | Loss 1385.8829 | F1 0.3350 0.2507 0.5051 | Speed (samples/sec) nan|nan | Load nan| train nan | GPU 681.5 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  2.69it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.77it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.83it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.91it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.90it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.85it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.90it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.85it/s]100%|██████████| 9/9 [00:02<00:00,  3.59it/s]100%|██████████| 9/9 [00:02<00:00,  3.04it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1089 MR 40.8761 Hits@1 0.0447 Hits@50 0.1358 Hits@100 0.2261 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4370
main_link_prediction.py[line:303]: - [Total] Epoch 00001 | Step 00001 | Loss 1015.8930 | F1 0.3415 0.2545 0.5192 | Speed (samples/sec) 12732.1711|38196.5133 | Load 0.2479| train 2.6257 | GPU 688.2 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.19it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.62it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.73it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.61it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.77it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.82it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.87it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.90it/s]100%|██████████| 9/9 [00:03<00:00,  3.46it/s]100%|██████████| 9/9 [00:03<00:00,  2.97it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1261 MR 36.0762 Hits@1 0.0539 Hits@50 0.1598 Hits@100 0.2639 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3803
main_link_prediction.py[line:303]: - [Total] Epoch 00002 | Step 00001 | Loss 836.5658 | F1 0.3461 0.2569 0.5305 | Speed (samples/sec) 17991.1512|53973.4535 | Load 0.4172| train 2.6671 | GPU 691.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.12it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.69it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.83it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.80it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.89it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.92it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.94it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.82it/s]100%|██████████| 9/9 [00:02<00:00,  3.57it/s]100%|██████████| 9/9 [00:02<00:00,  3.06it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1279 MR 34.8827 Hits@1 0.0532 Hits@50 0.1687 Hits@100 0.2672 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4195
main_link_prediction.py[line:303]: - [Total] Epoch 00003 | Step 00001 | Loss 712.0859 | F1 0.3488 0.2587 0.5354 | Speed (samples/sec) 19014.2755|57042.8264 | Load 0.4574| train 2.6770 | GPU 691.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.19it/s] 22%|██▏       | 2/9 [00:00<00:02,  3.00it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.75it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.82it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.61it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.73it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.78it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.68it/s]100%|██████████| 9/9 [00:03<00:00,  3.38it/s]100%|██████████| 9/9 [00:03<00:00,  2.93it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1233 MR 34.6260 Hits@1 0.0481 Hits@50 0.1646 Hits@100 0.2659 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4162
main_link_prediction.py[line:303]: - [Total] Epoch 00004 | Step 00001 | Loss 647.6715 | F1 0.3504 0.2596 0.5389 | Speed (samples/sec) 19444.0033|58332.0099 | Load 0.4728| train 2.6826 | GPU 692.6 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.16it/s] 22%|██▏       | 2/9 [00:00<00:02,  3.07it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.83it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.56it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.71it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.80it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.77it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.84it/s]100%|██████████| 9/9 [00:02<00:00,  3.57it/s]100%|██████████| 9/9 [00:03<00:00,  2.93it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1212 MR 34.3040 Hits@1 0.0445 Hits@50 0.1601 Hits@100 0.2658 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3867
main_link_prediction.py[line:303]: - [Total] Epoch 00005 | Step 00001 | Loss 580.6843 | F1 0.3504 0.2599 0.5379 | Speed (samples/sec) 19711.8650|59135.5950 | Load 0.4807| train 2.6830 | GPU 692.6 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.14it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.78it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.87it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.89it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.80it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.83it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.86it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.77it/s]100%|██████████| 9/9 [00:02<00:00,  3.50it/s]100%|██████████| 9/9 [00:02<00:00,  3.01it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1201 MR 33.9529 Hits@1 0.0428 Hits@50 0.1612 Hits@100 0.2674 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3944
main_link_prediction.py[line:303]: - [Total] Epoch 00006 | Step 00001 | Loss 526.2557 | F1 0.3487 0.2590 0.5332 | Speed (samples/sec) 19864.2157|59592.6472 | Load 0.4862| train 2.6835 | GPU 692.6 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.17it/s] 22%|██▏       | 2/9 [00:00<00:02,  3.06it/s] 33%|███▎      | 3/9 [00:00<00:01,  3.03it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.85it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.80it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.86it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.82it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.85it/s]100%|██████████| 9/9 [00:02<00:00,  3.61it/s]100%|██████████| 9/9 [00:02<00:00,  3.08it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1208 MR 33.7235 Hits@1 0.0427 Hits@50 0.1611 Hits@100 0.2665 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4549
main_link_prediction.py[line:303]: - [Total] Epoch 00007 | Step 00001 | Loss 476.9854 | F1 0.3489 0.2599 0.5309 | Speed (samples/sec) 19945.9942|59837.9826 | Load 0.4952| train 2.6834 | GPU 692.6 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.17it/s] 22%|██▏       | 2/9 [00:00<00:02,  3.09it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.91it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.93it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.94it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.95it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.97it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.93it/s]100%|██████████| 9/9 [00:02<00:00,  3.64it/s]100%|██████████| 9/9 [00:02<00:00,  3.14it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1188 MR 33.7821 Hits@1 0.0412 Hits@50 0.1602 Hits@100 0.2650 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3616
main_link_prediction.py[line:303]: - [Total] Epoch 00008 | Step 00001 | Loss 433.5397 | F1 0.3486 0.2595 0.5308 | Speed (samples/sec) 20040.9830|60122.9490 | Load 0.4941| train 2.6848 | GPU 692.6 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.17it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.97it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.94it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.87it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.86it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.61it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.72it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.77it/s]100%|██████████| 9/9 [00:02<00:00,  3.46it/s]100%|██████████| 9/9 [00:03<00:00,  2.95it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1198 MR 33.8556 Hits@1 0.0427 Hits@50 0.1604 Hits@100 0.2645 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4375
main_link_prediction.py[line:303]: - [Total] Epoch 00009 | Step 00001 | Loss 403.2515 | F1 0.3469 0.2580 0.5293 | Speed (samples/sec) 20088.9533|60266.8598 | Load 0.4993| train 2.6842 | GPU 692.6 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.16it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.77it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.87it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.91it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.93it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.94it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.57it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.67it/s]100%|██████████| 9/9 [00:03<00:00,  3.26it/s]100%|██████████| 9/9 [00:03<00:00,  2.93it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.1207 MR 33.7222 Hits@1 0.0430 Hits@50 0.1642 Hits@100 0.2667 NDCG 0.0000
main_link_prediction.py[line:330]: - Avg epoch time: 7.227824899885389
