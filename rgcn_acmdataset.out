Using backend: pytorch
main_link_prediction.py[line:410]: - Namespace(batch_size=100000, dataset='ACMDataset', decoder='DisMult', dropout=0.05, eval_every=1, fan_out='10,25', gpu=1, log_every=20, loss='CrossEntropyLoss', lr=0.001, margin=10.0, model='RGCN', neg_share=False, num_epochs=10, num_eval_negs=100, num_heads=[8, 4], num_hidden=64, num_layers=2, num_negs=3, num_output=64, num_workers=0)
Finished data loading.
  NumNodes: 30003
  NumEdges: 160686
  NumFeats: 128
  NumNodesType: 3
  NumRelsType: 6
main_link_prediction.py[line:168]: - --------------------------------------------------
main_link_prediction.py[line:169]: - Dataloader size: 2
main_link_prediction.py[line:170]: - Dataloader sample graph: 160686
main_link_prediction.py[line:171]: - Train Edges: 136587
main_link_prediction.py[line:172]: - Test Edges: 8020
main_link_prediction.py[line:173]: - Valid Edges: 16079
main_link_prediction.py[line:181]: - --------------------------------------------------
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/dgl/base.py:45: DGLWarning: Key word argument preserve_nodes is deprecated. Use relabel_nodes instead.
  return warnings.warn(message, category=category, stacklevel=1)
main_link_prediction.py:235: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370156314/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  select_ids = torch.cat([(input_nodes[k] == i).nonzero() for i in pos_graph.ndata['_ID'][k]]).squeeze()
main_link_prediction.py[line:299]: - Epoch Time(s): 7.7390
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3441: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
main_link_prediction.py[line:303]: - [Total] Epoch 00000 | Step 00001 | Loss 16.6365 | F1 0.3333 0.2500 0.4999 | Speed (samples/sec) nan|nan | Load nan| train nan | GPU 255.5 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  2.76it/s] 22%|██▏       | 2/9 [00:00<00:03,  2.12it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.31it/s] 44%|████▍     | 4/9 [00:01<00:02,  2.32it/s] 56%|█████▌    | 5/9 [00:02<00:01,  2.25it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.35it/s] 78%|███████▊  | 7/9 [00:03<00:00,  2.29it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.38it/s]100%|██████████| 9/9 [00:04<00:00,  2.14it/s]100%|██████████| 9/9 [00:04<00:00,  2.22it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0555 MR 46.1437 Hits@1 0.0090 Hits@50 0.0550 Hits@100 0.1182 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4542
main_link_prediction.py[line:303]: - [Total] Epoch 00001 | Step 00001 | Loss 16.6310 | F1 0.3335 0.2501 0.5003 | Speed (samples/sec) 12723.3744|38170.1232 | Load 0.2423| train 2.6333 | GPU 256.1 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.09it/s] 22%|██▏       | 2/9 [00:00<00:03,  2.28it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.23it/s] 44%|████▍     | 4/9 [00:01<00:02,  2.36it/s] 56%|█████▌    | 5/9 [00:02<00:01,  2.36it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.29it/s] 78%|███████▊  | 7/9 [00:03<00:00,  2.31it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.26it/s]100%|██████████| 9/9 [00:03<00:00,  2.65it/s]100%|██████████| 9/9 [00:03<00:00,  2.38it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0609 MR 43.6737 Hits@1 0.0100 Hits@50 0.0653 Hits@100 0.1360 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3937
main_link_prediction.py[line:303]: - [Total] Epoch 00002 | Step 00001 | Loss 16.6239 | F1 0.3337 0.2502 0.5008 | Speed (samples/sec) 17949.6140|53848.8420 | Load 0.4145| train 2.6750 | GPU 256.3 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.06it/s] 22%|██▏       | 2/9 [00:00<00:03,  2.00it/s] 33%|███▎      | 3/9 [00:01<00:03,  1.95it/s] 44%|████▍     | 4/9 [00:02<00:02,  1.90it/s] 56%|█████▌    | 5/9 [00:02<00:02,  1.91it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.10it/s] 78%|███████▊  | 7/9 [00:03<00:00,  2.21it/s] 89%|████████▉ | 8/9 [00:03<00:00,  1.92it/s]100%|██████████| 9/9 [00:04<00:00,  2.28it/s]100%|██████████| 9/9 [00:04<00:00,  2.05it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0659 MR 42.5273 Hits@1 0.0124 Hits@50 0.0749 Hits@100 0.1467 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3980
main_link_prediction.py[line:303]: - [Total] Epoch 00003 | Step 00001 | Loss 16.6167 | F1 0.3339 0.2503 0.5014 | Speed (samples/sec) 19023.3885|57070.1656 | Load 0.4487| train 2.6844 | GPU 256.3 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.03it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.67it/s] 33%|███▎      | 3/9 [00:01<00:03,  1.84it/s] 44%|████▍     | 4/9 [00:02<00:02,  1.85it/s] 56%|█████▌    | 5/9 [00:02<00:02,  1.95it/s] 67%|██████▋   | 6/9 [00:02<00:01,  1.94it/s] 78%|███████▊  | 7/9 [00:03<00:00,  2.13it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.20it/s]100%|██████████| 9/9 [00:04<00:00,  2.64it/s]100%|██████████| 9/9 [00:04<00:00,  2.10it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0731 MR 41.6409 Hits@1 0.0193 Hits@50 0.0803 Hits@100 0.1491 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3918
main_link_prediction.py[line:303]: - [Total] Epoch 00004 | Step 00001 | Loss 16.6073 | F1 0.3343 0.2505 0.5021 | Speed (samples/sec) 19472.0672|58416.2016 | Load 0.4637| train 2.6872 | GPU 256.3 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.05it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.73it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.81it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.59it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.38it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.44it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.18it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.07it/s]100%|██████████| 9/9 [00:03<00:00,  2.61it/s]100%|██████████| 9/9 [00:03<00:00,  2.37it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0768 MR 41.0897 Hits@1 0.0232 Hits@50 0.0822 Hits@100 0.1605 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3865
main_link_prediction.py[line:303]: - [Total] Epoch 00005 | Step 00001 | Loss 16.6019 | F1 0.3345 0.2507 0.5027 | Speed (samples/sec) 19733.8522|59201.5567 | Load 0.4729| train 2.6874 | GPU 256.3 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.16it/s] 22%|██▏       | 2/9 [00:00<00:02,  3.03it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.52it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.64it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.54it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.48it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.29it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.42it/s]100%|██████████| 9/9 [00:03<00:00,  3.05it/s]100%|██████████| 9/9 [00:03<00:00,  2.65it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0813 MR 40.7104 Hits@1 0.0256 Hits@50 0.0953 Hits@100 0.1662 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4016
main_link_prediction.py[line:303]: - [Total] Epoch 00006 | Step 00001 | Loss 16.5875 | F1 0.3351 0.2510 0.5040 | Speed (samples/sec) 19875.4514|59626.3541 | Load 0.4797| train 2.6879 | GPU 256.3 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.09it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.76it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.62it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.57it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.59it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.51it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.06it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.18it/s]100%|██████████| 9/9 [00:03<00:00,  2.61it/s]100%|██████████| 9/9 [00:03<00:00,  2.45it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0875 MR 40.5219 Hits@1 0.0311 Hits@50 0.1000 Hits@100 0.1692 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4311
main_link_prediction.py[line:303]: - [Total] Epoch 00007 | Step 00001 | Loss 16.5770 | F1 0.3356 0.2513 0.5053 | Speed (samples/sec) 19968.4001|59905.2004 | Load 0.4870| train 2.6879 | GPU 256.3 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.09it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.43it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.27it/s] 44%|████▍     | 4/9 [00:01<00:02,  2.46it/s] 56%|█████▌    | 5/9 [00:02<00:01,  2.47it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.60it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.49it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.10it/s]100%|██████████| 9/9 [00:03<00:00,  2.59it/s]100%|██████████| 9/9 [00:03<00:00,  2.45it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0893 MR 40.2396 Hits@1 0.0320 Hits@50 0.1041 Hits@100 0.1733 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3606
main_link_prediction.py[line:303]: - [Total] Epoch 00008 | Step 00001 | Loss 16.5709 | F1 0.3360 0.2515 0.5061 | Speed (samples/sec) 20060.7448|60182.2345 | Load 0.4859| train 2.6898 | GPU 256.3 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.08it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.96it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.75it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.62it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.51it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.27it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.22it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.18it/s]100%|██████████| 9/9 [00:03<00:00,  2.77it/s]100%|██████████| 9/9 [00:03<00:00,  2.43it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0887 MR 40.1793 Hits@1 0.0314 Hits@50 0.1036 Hits@100 0.1731 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4641
main_link_prediction.py[line:303]: - [Total] Epoch 00009 | Step 00001 | Loss 16.5635 | F1 0.3365 0.2518 0.5074 | Speed (samples/sec) 20097.6352|60292.9055 | Load 0.4914| train 2.6908 | GPU 256.5 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.08it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.72it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.54it/s] 44%|████▍     | 4/9 [00:01<00:02,  1.79it/s] 56%|█████▌    | 5/9 [00:02<00:02,  1.98it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.09it/s] 78%|███████▊  | 7/9 [00:03<00:00,  2.20it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.05it/s]100%|██████████| 9/9 [00:03<00:00,  2.48it/s]100%|██████████| 9/9 [00:04<00:00,  2.21it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0883 MR 40.0299 Hits@1 0.0304 Hits@50 0.0999 Hits@100 0.1731 NDCG 0.0000
main_link_prediction.py[line:330]: - Avg epoch time: 7.268952369689941
