Using backend: pytorch
main_link_prediction.py[line:410]: - Namespace(batch_size=100000, dataset='ACMDataset', decoder='DisMult', dropout=0.05, eval_every=1, fan_out='10,25', gpu=1, log_every=20, loss='CrossEntropyLoss', lr=0.001, margin=10.0, model='HetGNN', neg_share=False, num_epochs=10, num_eval_negs=100, num_heads=[8, 4], num_hidden=64, num_layers=2, num_negs=3, num_output=64, num_workers=0)
Finished data loading.
  NumNodes: 30003
  NumEdges: 160686
  NumFeats: 128
  NumNodesType: 3
  NumRelsType: 6
main_link_prediction.py[line:168]: - --------------------------------------------------
main_link_prediction.py[line:169]: - Dataloader size: 2
main_link_prediction.py[line:170]: - Dataloader sample graph: 160686
main_link_prediction.py[line:171]: - Train Edges: 136587
main_link_prediction.py[line:172]: - Test Edges: 8020
main_link_prediction.py[line:173]: - Valid Edges: 16079
main_link_prediction.py[line:181]: - --------------------------------------------------
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/dgl/base.py:45: DGLWarning: Key word argument preserve_nodes is deprecated. Use relabel_nodes instead.
  return warnings.warn(message, category=category, stacklevel=1)
main_link_prediction.py:235: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370156314/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  select_ids = torch.cat([(input_nodes[k] == i).nonzero() for i in pos_graph.ndata['_ID'][k]]).squeeze()
main_link_prediction.py[line:299]: - Epoch Time(s): 7.5534
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3441: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
main_link_prediction.py[line:303]: - [Total] Epoch 00000 | Step 00001 | Loss 16.9097 | F1 0.3332 0.2499 0.4999 | Speed (samples/sec) nan|nan | Load nan| train nan | GPU 304.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  2.80it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.74it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.77it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.75it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.69it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.70it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.72it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.71it/s]100%|██████████| 9/9 [00:03<00:00,  3.37it/s]100%|██████████| 9/9 [00:03<00:00,  2.88it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0492 MR 51.0033 Hits@1 0.0080 Hits@50 0.0461 Hits@100 0.0954 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4050
main_link_prediction.py[line:303]: - [Total] Epoch 00001 | Step 00001 | Loss 16.8583 | F1 0.3333 0.2500 0.4999 | Speed (samples/sec) 12809.8152|38429.4457 | Load 0.2456| train 2.6105 | GPU 309.8 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.16it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.88it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.85it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.85it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.83it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.87it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.83it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.82it/s]100%|██████████| 9/9 [00:03<00:00,  3.29it/s]100%|██████████| 9/9 [00:03<00:00,  2.95it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0495 MR 50.9601 Hits@1 0.0083 Hits@50 0.0464 Hits@100 0.0970 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3619
main_link_prediction.py[line:303]: - [Total] Epoch 00002 | Step 00001 | Loss 16.8629 | F1 0.3334 0.2500 0.5001 | Speed (samples/sec) 18048.1454|54144.4363 | Load 0.4183| train 2.6540 | GPU 309.8 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.12it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.50it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.60it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.63it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.71it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.70it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.74it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.73it/s]100%|██████████| 9/9 [00:03<00:00,  3.47it/s]100%|██████████| 9/9 [00:03<00:00,  2.88it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0495 MR 50.9438 Hits@1 0.0080 Hits@50 0.0475 Hits@100 0.0969 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3781
main_link_prediction.py[line:303]: - [Total] Epoch 00003 | Step 00001 | Loss 16.8695 | F1 0.3331 0.2499 0.4996 | Speed (samples/sec) 19108.2251|57324.6753 | Load 0.4526| train 2.6664 | GPU 309.8 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.10it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.92it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.78it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.57it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.65it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.69it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.73it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.71it/s]100%|██████████| 9/9 [00:03<00:00,  3.38it/s]100%|██████████| 9/9 [00:03<00:00,  2.89it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0491 MR 50.8045 Hits@1 0.0076 Hits@50 0.0473 Hits@100 0.0999 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3568
main_link_prediction.py[line:303]: - [Total] Epoch 00004 | Step 00001 | Loss 16.8280 | F1 0.3334 0.2501 0.5001 | Speed (samples/sec) 19553.7137|58661.1410 | Load 0.4682| train 2.6676 | GPU 309.8 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.08it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.98it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.64it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.66it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.67it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.71it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.59it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.65it/s]100%|██████████| 9/9 [00:03<00:00,  3.27it/s]100%|██████████| 9/9 [00:03<00:00,  2.84it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0505 MR 50.7818 Hits@1 0.0094 Hits@50 0.0473 Hits@100 0.0975 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3725
main_link_prediction.py[line:303]: - [Total] Epoch 00005 | Step 00001 | Loss 16.8263 | F1 0.3332 0.2499 0.4998 | Speed (samples/sec) 19807.8037|59423.4110 | Load 0.4773| train 2.6697 | GPU 311.1 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.14it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.90it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.86it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.77it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.77it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.73it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.76it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.79it/s]100%|██████████| 9/9 [00:03<00:00,  3.37it/s]100%|██████████| 9/9 [00:03<00:00,  2.93it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0517 MR 50.6323 Hits@1 0.0101 Hits@50 0.0489 Hits@100 0.0989 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3544
main_link_prediction.py[line:303]: - [Total] Epoch 00006 | Step 00001 | Loss 16.8292 | F1 0.3333 0.2500 0.5000 | Speed (samples/sec) 19966.1597|59898.4790 | Load 0.4829| train 2.6695 | GPU 311.1 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.18it/s] 22%|██▏       | 2/9 [00:00<00:02,  3.00it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.86it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.62it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.73it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.73it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.73it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.71it/s]100%|██████████| 9/9 [00:03<00:00,  3.30it/s]100%|██████████| 9/9 [00:03<00:00,  2.90it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0526 MR 50.5204 Hits@1 0.0111 Hits@50 0.0504 Hits@100 0.1010 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3789
main_link_prediction.py[line:303]: - [Total] Epoch 00007 | Step 00001 | Loss 16.7865 | F1 0.3337 0.2503 0.5006 | Speed (samples/sec) 20077.1429|60231.4286 | Load 0.4876| train 2.6705 | GPU 311.1 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.19it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.93it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.87it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.83it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.80it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.76it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.76it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.42it/s]100%|██████████| 9/9 [00:03<00:00,  2.97it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0537 MR 50.3289 Hits@1 0.0116 Hits@50 0.0527 Hits@100 0.1038 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3516
main_link_prediction.py[line:303]: - [Total] Epoch 00008 | Step 00001 | Loss 16.7769 | F1 0.3336 0.2502 0.5003 | Speed (samples/sec) 20158.6653|60475.9958 | Load 0.4900| train 2.6704 | GPU 311.1 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.17it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.98it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.86it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.76it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.52it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.62it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.67it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.67it/s]100%|██████████| 9/9 [00:03<00:00,  3.30it/s]100%|██████████| 9/9 [00:03<00:00,  2.84it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0560 MR 50.2064 Hits@1 0.0133 Hits@50 0.0555 Hits@100 0.1047 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4234
main_link_prediction.py[line:303]: - [Total] Epoch 00009 | Step 00001 | Loss 16.7510 | F1 0.3337 0.2503 0.5005 | Speed (samples/sec) 20201.3953|60604.1859 | Load 0.4949| train 2.6715 | GPU 311.1 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.13it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.94it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.82it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.82it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.74it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.72it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.70it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.73it/s]100%|██████████| 9/9 [00:03<00:00,  3.36it/s]100%|██████████| 9/9 [00:03<00:00,  2.92it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0570 MR 49.9581 Hits@1 0.0134 Hits@50 0.0593 Hits@100 0.1106 NDCG 0.0000
main_link_prediction.py[line:330]: - Avg epoch time: 7.215103016959296
