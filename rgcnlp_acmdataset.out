Using backend: pytorch
main_link_prediction.py[line:410]: - Namespace(batch_size=100000, dataset='ACMDataset', decoder='DisMult', dropout=0.05, eval_every=1, fan_out='10,25', gpu=1, log_every=20, loss='CrossEntropyLoss', lr=0.001, margin=10.0, model='RGCN_Hetero_Link_Prediction', neg_share=False, num_epochs=10, num_eval_negs=100, num_heads=[8, 4], num_hidden=64, num_layers=2, num_negs=3, num_output=64, num_workers=0)
Finished data loading.
  NumNodes: 30003
  NumEdges: 160686
  NumFeats: 128
  NumNodesType: 3
  NumRelsType: 6
main_link_prediction.py[line:168]: - --------------------------------------------------
main_link_prediction.py[line:169]: - Dataloader size: 2
main_link_prediction.py[line:170]: - Dataloader sample graph: 160686
main_link_prediction.py[line:171]: - Train Edges: 136587
main_link_prediction.py[line:172]: - Test Edges: 8020
main_link_prediction.py[line:173]: - Valid Edges: 16079
main_link_prediction.py[line:181]: - --------------------------------------------------
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/dgl/base.py:45: DGLWarning: Key word argument preserve_nodes is deprecated. Use relabel_nodes instead.
  return warnings.warn(message, category=category, stacklevel=1)
main_link_prediction.py:235: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370156314/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  select_ids = torch.cat([(input_nodes[k] == i).nonzero() for i in pos_graph.ndata['_ID'][k]]).squeeze()
main_link_prediction.py[line:299]: - Epoch Time(s): 7.8204
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3441: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/LAB/zengfr/anaconda3/envs/xyf_conda/lib/python3.7/site-packages/numpy/core/_methods.py:189: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
main_link_prediction.py[line:303]: - [Total] Epoch 00000 | Step 00001 | Loss 16.6354 | F1 0.3333 0.2500 0.5000 | Speed (samples/sec) nan|nan | Load nan| train nan | GPU 307.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  2.87it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.61it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.53it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.71it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.81it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.73it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.48it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.57it/s]100%|██████████| 9/9 [00:03<00:00,  3.06it/s]100%|██████████| 9/9 [00:03<00:00,  2.70it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0886 MR 40.1475 Hits@1 0.0338 Hits@50 0.0963 Hits@100 0.1648 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4329
main_link_prediction.py[line:303]: - [Total] Epoch 00001 | Step 00001 | Loss 16.6344 | F1 0.3334 0.2500 0.5001 | Speed (samples/sec) 12757.9820|38273.9459 | Load 0.2498| train 2.6180 | GPU 311.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.25it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.46it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.62it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.63it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.48it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.59it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.41it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.52it/s]100%|██████████| 9/9 [00:03<00:00,  2.59it/s]100%|██████████| 9/9 [00:03<00:00,  2.53it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0937 MR 39.7181 Hits@1 0.0369 Hits@50 0.1071 Hits@100 0.1779 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3808
main_link_prediction.py[line:303]: - [Total] Epoch 00002 | Step 00001 | Loss 16.6315 | F1 0.3335 0.2501 0.5005 | Speed (samples/sec) 17985.1781|53955.5342 | Load 0.4233| train 2.6593 | GPU 311.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.18it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.56it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.54it/s] 44%|████▍     | 4/9 [00:01<00:02,  2.50it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.64it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.56it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.51it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.54it/s]100%|██████████| 9/9 [00:03<00:00,  3.16it/s]100%|██████████| 9/9 [00:03<00:00,  2.59it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0935 MR 39.9292 Hits@1 0.0361 Hits@50 0.1072 Hits@100 0.1777 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3939
main_link_prediction.py[line:303]: - [Total] Epoch 00003 | Step 00001 | Loss 16.6261 | F1 0.3337 0.2502 0.5010 | Speed (samples/sec) 19042.6817|57128.0452 | Load 0.4584| train 2.6697 | GPU 311.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.16it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.59it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.69it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.71it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.73it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.79it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.65it/s] 89%|████████▉ | 8/9 [00:02<00:00,  2.66it/s]100%|██████████| 9/9 [00:03<00:00,  3.19it/s]100%|██████████| 9/9 [00:03<00:00,  2.83it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0924 MR 40.1034 Hits@1 0.0359 Hits@50 0.1065 Hits@100 0.1781 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3749
main_link_prediction.py[line:303]: - [Total] Epoch 00004 | Step 00001 | Loss 16.6176 | F1 0.3340 0.2503 0.5020 | Speed (samples/sec) 19492.1569|58476.4708 | Load 0.4724| train 2.6726 | GPU 311.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.22it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.69it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.61it/s] 44%|████▍     | 4/9 [00:01<00:02,  2.46it/s] 56%|█████▌    | 5/9 [00:02<00:01,  2.16it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.28it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.43it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.55it/s]100%|██████████| 9/9 [00:03<00:00,  2.90it/s]100%|██████████| 9/9 [00:03<00:00,  2.47it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0930 MR 40.2781 Hits@1 0.0364 Hits@50 0.1085 Hits@100 0.1766 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3830
main_link_prediction.py[line:303]: - [Total] Epoch 00005 | Step 00001 | Loss 16.6026 | F1 0.3347 0.2506 0.5036 | Speed (samples/sec) 19747.5279|59242.5836 | Load 0.4814| train 2.6738 | GPU 311.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.30it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.37it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.62it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.77it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.79it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.36it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.07it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.17it/s]100%|██████████| 9/9 [00:03<00:00,  2.49it/s]100%|██████████| 9/9 [00:03<00:00,  2.43it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0931 MR 40.3263 Hits@1 0.0371 Hits@50 0.1053 Hits@100 0.1740 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3819
main_link_prediction.py[line:303]: - [Total] Epoch 00006 | Step 00001 | Loss 16.5765 | F1 0.3357 0.2511 0.5063 | Speed (samples/sec) 19900.3937|59701.1811 | Load 0.4865| train 2.6752 | GPU 311.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.24it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.89it/s] 33%|███▎      | 3/9 [00:01<00:03,  1.94it/s] 44%|████▍     | 4/9 [00:01<00:02,  2.25it/s] 56%|█████▌    | 5/9 [00:02<00:01,  2.30it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.13it/s] 78%|███████▊  | 7/9 [00:03<00:00,  2.32it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.46it/s]100%|██████████| 9/9 [00:03<00:00,  3.17it/s]100%|██████████| 9/9 [00:03<00:00,  2.52it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0929 MR 40.4173 Hits@1 0.0366 Hits@50 0.1065 Hits@100 0.1789 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4486
main_link_prediction.py[line:303]: - [Total] Epoch 00007 | Step 00001 | Loss 16.5581 | F1 0.3371 0.2517 0.5102 | Speed (samples/sec) 19983.2439|59949.7316 | Load 0.4946| train 2.6767 | GPU 311.9 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.23it/s] 22%|██▏       | 2/9 [00:00<00:02,  2.64it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.35it/s] 44%|████▍     | 4/9 [00:01<00:02,  2.25it/s] 56%|█████▌    | 5/9 [00:02<00:01,  2.16it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.30it/s] 78%|███████▊  | 7/9 [00:03<00:00,  2.15it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.17it/s]100%|██████████| 9/9 [00:03<00:00,  2.71it/s]100%|██████████| 9/9 [00:03<00:00,  2.38it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0930 MR 40.4134 Hits@1 0.0368 Hits@50 0.1062 Hits@100 0.1771 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.3705
main_link_prediction.py[line:303]: - [Total] Epoch 00008 | Step 00001 | Loss 16.5263 | F1 0.3388 0.2525 0.5147 | Speed (samples/sec) 20067.0818|60201.2453 | Load 0.4943| train 2.6788 | GPU 312.1 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.27it/s] 22%|██▏       | 2/9 [00:00<00:02,  3.34it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.76it/s] 44%|████▍     | 4/9 [00:01<00:01,  2.63it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.67it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.28it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.35it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.20it/s]100%|██████████| 9/9 [00:03<00:00,  2.78it/s]100%|██████████| 9/9 [00:03<00:00,  2.49it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0926 MR 40.3352 Hits@1 0.0356 Hits@50 0.1069 Hits@100 0.1768 NDCG 0.0000
main_link_prediction.py[line:299]: - Epoch Time(s): 6.4606
main_link_prediction.py[line:303]: - [Total] Epoch 00009 | Step 00001 | Loss 16.5050 | F1 0.3409 0.2535 0.5205 | Speed (samples/sec) 20104.3559|60313.0678 | Load 0.5005| train 2.6794 | GPU 312.1 MB
utils.py[line:250]: - eval subgraph edge number: 16079
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:02,  3.26it/s] 22%|██▏       | 2/9 [00:00<00:02,  3.02it/s] 33%|███▎      | 3/9 [00:01<00:02,  2.27it/s] 44%|████▍     | 4/9 [00:01<00:02,  2.45it/s] 56%|█████▌    | 5/9 [00:01<00:01,  2.58it/s] 67%|██████▋   | 6/9 [00:02<00:01,  2.59it/s] 78%|███████▊  | 7/9 [00:02<00:00,  2.30it/s] 89%|████████▉ | 8/9 [00:03<00:00,  2.26it/s]100%|██████████| 9/9 [00:03<00:00,  2.97it/s]100%|██████████| 9/9 [00:03<00:00,  2.60it/s]
main_link_prediction.py[line:308]: - Eval Link Prediction valid MRR 0.0935 MR 39.9335 Hits@1 0.0363 Hits@50 0.1078 Hits@100 0.1759 NDCG 0.0000
main_link_prediction.py[line:330]: - Avg epoch time: 7.271943860583836
